<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–•—ñ–º–¢—Ä–µ–Ω–µ—Ä ‚Äî –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä –∑ —Ö—ñ–º—ñ—ó</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öóÔ∏è</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;600;700&family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f4f3f0;
  --bg2: #eae8e3;
  --card: #ffffff;
  --card2: #faf9f7;
  --border: #e0ddd6;
  --border2: #d0ccc3;
  --text: #1a1a2e;
  --text2: #555566;
  --text3: #888899;
  --accent: #0d8a6a;
  --accent2: #0077aa;
  --accentBg: #0d8a6a12;
  --danger: #cc3344;
  --dangerBg: #cc334410;
  --warn: #cc7700;
  --success: #0d8a6a;
  --successBg: #0d8a6a10;
  --purple: #6644bb;
  --shadow: 0 2px 12px rgba(0,0,0,.06);
  --shadow2: 0 4px 20px rgba(0,0,0,.08);
  --font: 'Comfortaa', cursive;
  --mono: 'Fira Code', monospace;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);font-family:var(--font);color:var(--text);min-height:100vh;overflow-x:hidden;}
img{max-width:100%;}

@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes popIn{from{opacity:0;transform:scale(.88)}to{opacity:1;transform:scale(1)}}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes streakPop{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-3px)}40%,80%{transform:translateX(3px)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
@keyframes ptsAnim{0%{opacity:1;transform:translate(-50%,-50%) scale(1)}100%{opacity:0;transform:translate(-50%,-80%) scale(1.4)}}

button{font-family:var(--font);cursor:pointer;border:none;outline:none;}
button:active{transform:scale(.97)!important;}

.app{padding:16px 0 60px;min-height:100vh;}
.container{max-width:520px;margin:0 auto;padding:0 16px;}

/* Header */
.header{text-align:center;margin-bottom:24px;padding-top:12px;animation:fadeIn .5s ease;}
.header-flask{font-size:48px;margin-bottom:2px;animation:float 3s ease-in-out infinite;}
.header h1{font-size:24px;font-weight:700;color:var(--accent);margin:0 0 2px;letter-spacing:.5px;}
.header .sub{color:var(--text3);font-size:12px;}

/* Stats */
.stats-bar{display:flex;gap:8px;margin-bottom:18px;animation:fadeIn .4s ease .1s both;}
.stat-chip{flex:1;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px 6px;text-align:center;box-shadow:var(--shadow);}
.stat-chip .val{font-size:18px;font-weight:700;font-family:var(--mono);color:var(--accent);}
.stat-chip .label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.8px;margin-top:2px;}

/* Levels */
.levels{display:flex;flex-direction:column;gap:8px;}
.level-row{
  display:flex;align-items:center;gap:12px;
  background:var(--card);border:1px solid var(--border);border-radius:14px;
  padding:12px 14px;transition:all .2s;position:relative;overflow:hidden;
  box-shadow:var(--shadow);animation:slideUp .35s ease both;
}
.level-row:not(.locked):hover{border-color:var(--accent);box-shadow:var(--shadow2);}
.level-row.locked{opacity:.4;cursor:not-allowed;}
.level-row.locked::after{content:'üîí';position:absolute;right:14px;top:50%;transform:translateY(-50%);font-size:16px;}
.level-row .icon{font-size:26px;width:42px;height:42px;display:flex;align-items:center;justify-content:center;border-radius:11px;flex-shrink:0;}
.level-row .info{flex:1;min-width:0;}
.level-row .info .name{font-size:13px;font-weight:700;margin-bottom:1px;}
.level-row .info .sub{font-size:11px;color:var(--text3);}
.level-row .stars-display{font-size:13px;flex-shrink:0;}
.level-row .best-score{font-size:11px;color:var(--text3);font-family:var(--mono);flex-shrink:0;margin-left:4px;}

/* Ref button */
.ref-btn{
  width:100%;padding:11px 14px;background:var(--card);border:1px solid var(--border);
  border-radius:12px;display:flex;align-items:center;gap:10px;margin-bottom:18px;
  transition:border-color .2s;color:var(--text);box-shadow:var(--shadow);
  animation:fadeIn .4s ease .12s both;
}
.ref-btn:hover{border-color:var(--accent);}
.ref-btn .icon{font-size:20px;}
.ref-btn .title{font-size:13px;font-weight:700;text-align:left;}
.ref-btn .sub{font-size:10px;color:var(--text3);text-align:left;}

/* Quiz */
.top-bar{display:flex;align-items:center;gap:8px;margin-bottom:14px;}
.back-btn{background:var(--card);border:1px solid var(--border);color:var(--text2);font-size:18px;padding:6px 10px;border-radius:10px;transition:all .2s;}
.back-btn:hover{border-color:var(--accent);color:var(--text);}
.top-bar h3{font-size:15px;font-weight:700;flex:1;}
.score-pill{
  background:var(--accentBg);border:1px solid var(--accent)33;border-radius:20px;
  padding:4px 12px;font-family:var(--mono);font-size:13px;font-weight:700;color:var(--accent);
}

/* Progress */
.progress{margin-bottom:18px;}
.progress-meta{display:flex;justify-content:space-between;font-size:11px;color:var(--text3);margin-bottom:4px;font-family:var(--mono);}
.progress-track{height:5px;background:var(--bg2);border-radius:3px;overflow:hidden;}
.progress-fill{height:100%;border-radius:3px;transition:width .4s ease;}

/* Streak */
.streak-bar{display:flex;align-items:center;justify-content:center;gap:6px;margin-bottom:14px;min-height:26px;}
.streak-badge{
  background:#ff880012;border:1px solid #ff880033;border-radius:20px;
  padding:2px 10px;font-size:11px;font-weight:700;color:#cc6600;font-family:var(--mono);
}
.streak-badge.big{animation:streakPop .4s ease;font-size:13px;color:#cc5500;}

/* Q card */
.q-card{
  background:var(--card);border:1px solid var(--border);border-radius:16px;
  padding:20px;margin-bottom:16px;position:relative;overflow:hidden;
  box-shadow:var(--shadow);animation:slideUp .3s ease;
}
.q-card .prompt{font-size:17px;font-weight:700;margin:0 0 5px;line-height:1.4;color:var(--text);}
.q-card .extra{color:var(--text3);font-size:12px;margin:0;font-family:var(--mono);}
.q-card .q-num{position:absolute;top:10px;right:12px;font-size:10px;color:var(--text3);font-family:var(--mono);}
.q-card .level-tag{font-size:9px;color:var(--accent2);background:var(--accent2)10;padding:2px 8px;border-radius:6px;display:inline-block;margin-bottom:6px;border:1px solid var(--accent2)22;}

.swatch{margin:0 auto 12px;}
.swatch-rect{width:52px;height:52px;border-radius:10px;border:2px solid var(--border2);}
.swatch-flame{width:68px;height:68px;border-radius:50% 50% 50% 50% / 60% 60% 40% 40%;animation:float 2s ease-in-out infinite;}

.q-image{border-radius:12px;overflow:hidden;margin-bottom:12px;max-height:180px;display:flex;justify-content:center;background:var(--bg2);}
.q-image img{max-height:180px;object-fit:cover;border-radius:12px;width:100%;}

/* Options */
.prompt-label{color:var(--text3);font-size:11px;margin-bottom:7px;font-family:var(--mono);}
.options{display:flex;flex-direction:column;gap:7px;margin-bottom:14px;}
.opt{
  width:100%;padding:12px 14px;background:var(--card2);border:2px solid var(--border);
  border-radius:12px;color:var(--text);font-size:14px;text-align:left;transition:all .2s;
}
.opt:hover:not(:disabled){border-color:var(--accent2);background:#f0f8ff;}
.opt.correct{background:#0d8a6a14;border-color:var(--success);color:var(--success);font-weight:700;animation:pulse .3s ease;}
.opt.wrong{background:#cc334410;border-color:var(--danger);color:var(--danger);animation:shake .4s ease;}
.opt.dimmed{opacity:.3;}
.opt:disabled{cursor:default;}

/* Pts popup */
.pts-popup{
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:32px;font-weight:700;font-family:var(--mono);
  pointer-events:none;z-index:100;animation:ptsAnim .8s ease forwards;
  text-shadow:0 2px 8px rgba(0,0,0,.1);
}

/* Feedback */
.feedback{border-radius:12px;padding:10px 14px;margin-bottom:12px;animation:fadeIn .25s ease;}
.feedback.ok{background:var(--successBg);border:1px solid var(--success)22;}
.feedback.err{background:var(--dangerBg);border:1px solid var(--danger)22;}
.feedback .verdict{margin:0;font-size:13px;font-weight:700;}
.feedback .explanation{color:var(--text2);margin:2px 0 0;font-size:12px;}

/* Finish */
.finish{text-align:center;padding:32px 16px;animation:popIn .5s ease;}
.finish .stars-big{font-size:40px;margin-bottom:8px;}
.finish h2{margin-bottom:4px;font-size:20px;}
.finish .pts-final{font-size:26px;font-weight:700;font-family:var(--mono);color:var(--accent);margin-bottom:4px;}
.finish .count{color:var(--text2);font-size:13px;margin-bottom:4px;font-family:var(--mono);}
.finish .msg{color:var(--text2);font-size:14px;margin-bottom:24px;}
.finish .unlock-msg{
  background:var(--accentBg);border:1px solid var(--accent)33;border-radius:12px;
  padding:10px 14px;margin-bottom:16px;color:var(--accent);font-size:13px;font-weight:700;
}
.finish-btns{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;}

.mistakes-list{display:flex;flex-direction:column;gap:6px;margin-bottom:16px;text-align:left;}
.mistake-card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:10px 14px;box-shadow:var(--shadow);}
.mistake-card .q{font-size:13px;font-weight:700;margin-bottom:3px;color:var(--danger);}
.mistake-card .a{font-size:12px;color:var(--success);}

.btn-primary{
  padding:10px 22px;background:var(--accent);border-radius:12px;
  color:#fff;font-size:14px;font-weight:700;box-shadow:0 3px 12px var(--accent)33;transition:all .2s;
}
.btn-primary:hover{box-shadow:0 4px 16px var(--accent)44;transform:translateY(-1px);}
.btn-secondary{
  padding:10px 22px;background:var(--card);border:1px solid var(--border);
  border-radius:12px;color:var(--text2);font-size:14px;transition:border-color .2s;
}
.btn-secondary:hover{border-color:var(--accent);}
.btn-danger{padding:8px 16px;background:var(--dangerBg);border:1px solid var(--danger)22;border-radius:10px;color:var(--danger);font-size:12px;}

/* Reference */
.ref-tabs{display:flex;gap:5px;margin-bottom:16px;flex-wrap:wrap;}
.ref-tab{padding:6px 12px;border-radius:20px;font-size:12px;background:var(--card);border:1px solid var(--border);color:var(--text3);transition:all .2s;}
.ref-tab.active{border-color:var(--accent);background:var(--accentBg);color:var(--accent);}
.ref-grid{display:grid;gap:8px;}
.ref-grid.p{grid-template-columns:repeat(auto-fill,minmax(145px,1fr));}
.ref-grid.f{grid-template-columns:repeat(auto-fill,minmax(125px,1fr));}
.ref-grid.m{grid-template-columns:repeat(auto-fill,minmax(170px,1fr));}
.ref-card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:10px;text-align:center;box-shadow:var(--shadow);}
.ref-card .formula{font-size:13px;font-weight:700;margin:0 0 2px;font-family:var(--mono);}
.ref-card .detail{color:var(--text3);font-size:10px;margin:0;}
.mineral-card{overflow:hidden;padding:0!important;}
.mineral-card .img-wrap{height:100px;background:var(--bg2);display:flex;justify-content:center;align-items:center;overflow:hidden;}
.mineral-card .img-wrap img{max-height:100px;object-fit:cover;width:100%;}
.mineral-card .info{padding:8px 10px;text-align:left;}
.mineral-card .info .name{font-size:12px;font-weight:700;margin:0 0 2px;}
.mineral-card .info .formula{color:var(--accent);font-size:11px;margin:0 0 1px;font-family:var(--mono);text-align:left;}
.mineral-card .info .detail{text-align:left;}
.smell-row{border:1px solid var(--border);border-radius:10px;padding:10px 14px;display:flex;align-items:center;gap:10px;background:var(--card);box-shadow:var(--shadow);}
.smell-row .emoji{font-size:24px;}
.smell-row .substance{font-size:13px;font-weight:700;margin:0 0 1px;}
.smell-row .smell{color:var(--text3);font-size:11px;margin:0;}
.list-row{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:8px 12px;display:flex;justify-content:space-between;align-items:center;box-shadow:var(--shadow);}
.footer{text-align:center;color:var(--text3);font-size:10px;margin-top:20px;font-family:var(--mono);}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:#00000033;display:flex;align-items:center;justify-content:center;z-index:999;animation:fadeIn .15s ease;}
.modal{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:22px;max-width:320px;width:90%;text-align:center;box-shadow:var(--shadow2);animation:popIn .25s ease;}
.modal h3{margin-bottom:6px;font-size:16px;}
.modal p{color:var(--text2);font-size:13px;margin-bottom:16px;}
.modal .btns{display:flex;gap:8px;justify-content:center;}

@media(max-width:480px){
  .ref-grid.p,.ref-grid.f{grid-template-columns:repeat(auto-fill,minmax(115px,1fr));}
  .ref-grid.m{grid-template-columns:1fr;}
  .stat-chip .val{font-size:16px;}
}
</style>
</head>
<body>
<div id="app" class="app"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.3.1/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.3.1/umd/react-dom.production.min.js"></script>
<script>
const{useState,useEffect,useCallback,useRef,createElement:h}=React;

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const TRIVIAL_NAMES=[{trivial:"–ù–µ–≥–∞—à–µ–Ω–µ –≤–∞–ø–Ω–æ",formula:"CaO",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–ì–∞—à–µ–Ω–µ –≤–∞–ø–Ω–æ",formula:"Ca(OH)‚ÇÇ",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{trivial:"–ö–∞—É—Å—Ç–∏—á–Ω–∞ —Å–æ–¥–∞",formula:"NaOH",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{trivial:"–ö–∞–ª—å—Ü–∏–Ω–æ–≤–∞–Ω–∞ —Å–æ–¥–∞",formula:"Na‚ÇÇCO‚ÇÉ",group:"—Å–æ–ª—ñ"},{trivial:"–•–∞—Ä—á–æ–≤–∞ —Å–æ–¥–∞",formula:"NaHCO‚ÇÉ",group:"—Å–æ–ª—ñ"},{trivial:"–ü–æ—Ç–∞—à",formula:"K‚ÇÇCO‚ÇÉ",group:"—Å–æ–ª—ñ"},{trivial:"–ù–∞—à–∞—Ç–∏—Ä",formula:"NH‚ÇÑCl",group:"—Å–æ–ª—ñ"},{trivial:"–õ—è–ø—ñ—Å",formula:"AgNO‚ÇÉ",group:"—Å–æ–ª—ñ"},{trivial:"–°—ñ–ª—å –ë–µ—Ä—Ç–æ–ª–µ",formula:"KClO‚ÇÉ",group:"—Å–æ–ª—ñ"},{trivial:"–ì–ª–∞—É–±–µ—Ä–æ–≤–∞ —Å—ñ–ª—å",formula:"Na‚ÇÇSO‚ÇÑ¬∑10H‚ÇÇO",group:"–∫—Ä–∏—Å—Ç–∞–ª–æ–≥—ñ–¥—Ä–∞—Ç–∏"},{trivial:"–ú—ñ–¥–Ω–∏–π –∫—É–ø–æ—Ä–æ—Å",formula:"CuSO‚ÇÑ¬∑5H‚ÇÇO",group:"–∫—Ä–∏—Å—Ç–∞–ª–æ–≥—ñ–¥—Ä–∞—Ç–∏"},{trivial:"–ó–∞–ª—ñ–∑–Ω–∏–π –∫—É–ø–æ—Ä–æ—Å",formula:"FeSO‚ÇÑ¬∑7H‚ÇÇO",group:"–∫—Ä–∏—Å—Ç–∞–ª–æ–≥—ñ–¥—Ä–∞—Ç–∏"},{trivial:"–ü–∞–ª–µ–Ω–∞ –º–∞–≥–Ω–µ–∑—ñ—è",formula:"MgO",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–°—É—Ö–∏–π –ª—ñ–¥",formula:"CO‚ÇÇ (—Ç–≤.)",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–ß–∞–¥–Ω–∏–π –≥–∞–∑",formula:"CO",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–í–µ—Å–µ–ª—è—â–∏–π –≥–∞–∑",formula:"N‚ÇÇO",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–ë—É—Ä–∏–π –≥–∞–∑",formula:"NO‚ÇÇ",group:"–æ–∫—Å–∏–¥–∏"},{trivial:"–¶–∞—Ä—Å—å–∫–∞ –≥–æ—Ä—ñ–ª–∫–∞",formula:"HNO‚ÇÉ + 3HCl",group:"—Å—É–º—ñ—à—ñ"},{trivial:"–û–ª–µ—É–º",formula:"H‚ÇÇSO‚ÇÑ¬∑SO‚ÇÉ",group:"–∫–∏—Å–ª–æ—Ç–∏"},{trivial:"–ì—Ä–∏–º—É—á–∏–π –≥–∞–∑",formula:"2H‚ÇÇ + O‚ÇÇ",group:"—Å—É–º—ñ—à—ñ"},{trivial:"–§–æ—Ä–º–∞–ª—ñ–Ω",formula:"40% —Ä-–Ω HCHO",group:"—Ä–æ–∑—á–∏–Ω–∏"},{trivial:"–î–µ—Ä–µ–≤–Ω–∏–π —Å–ø–∏—Ä—Ç",formula:"CH‚ÇÉOH",group:"—Å–ø–∏—Ä—Ç–∏"},{trivial:"–í–∏–Ω–Ω–∏–π —Å–ø–∏—Ä—Ç",formula:"C‚ÇÇH‚ÇÖOH",group:"—Å–ø–∏—Ä—Ç–∏"},{trivial:"–ö–∞—Ä–±–æ–ª–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",formula:"C‚ÇÜH‚ÇÖOH",group:"—Ñ–µ–Ω–æ–ª–∏"},{trivial:"–ê–º—ñ–∞—á–Ω–∞ —Å–µ–ª—ñ—Ç—Ä–∞",formula:"NH‚ÇÑNO‚ÇÉ",group:"—Å–µ–ª—ñ—Ç—Ä–∏"},{trivial:"–ß–∏–ª—ñ–π—Å—å–∫–∞ —Å–µ–ª—ñ—Ç—Ä–∞",formula:"NaNO‚ÇÉ",group:"—Å–µ–ª—ñ—Ç—Ä–∏"},{trivial:"–Ü–Ω–¥—ñ–π—Å—å–∫–∞ —Å–µ–ª—ñ—Ç—Ä–∞",formula:"KNO‚ÇÉ",group:"—Å–µ–ª—ñ—Ç—Ä–∏"},{trivial:"–ù–æ—Ä–≤–µ–∑—å–∫–∞ —Å–µ–ª—ñ—Ç—Ä–∞",formula:"Ca(NO‚ÇÉ)‚ÇÇ",group:"—Å–µ–ª—ñ—Ç—Ä–∏"},{trivial:"–†—ñ–¥–∫–µ —Å–∫–ª–æ",formula:"Na‚ÇÇSiO‚ÇÉ (–≤–æ–¥–Ω.)",group:"—Ä–æ–∑—á–∏–Ω–∏"},{trivial:"–ù–∞—à–∞—Ç–∏—Ä–Ω–∏–π —Å–ø–∏—Ä—Ç",formula:"NH‚ÇÉ¬∑H‚ÇÇO",group:"—Ä–æ–∑—á–∏–Ω–∏"},{trivial:"–°–∏–Ω—Ç–µ–∑-–≥–∞–∑",formula:"CO + H‚ÇÇ",group:"—Å—É–º—ñ—à—ñ"},{trivial:"–õ—å–æ–¥—è–Ω–∞ –æ—Ü—Ç–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",formula:"100% CH‚ÇÉCOOH",group:"–∫–∏—Å–ª–æ—Ç–∏"}];

const MINERALS=[
  {name:"–ö–∞–ª—å—Ü–∏—Ç (–∫—Ä–µ–π–¥–∞, –≤–∞–ø–Ω—è–∫)",formula:"CaCO‚ÇÉ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Calcite-sample2.jpg/440px-Calcite-sample2.jpg",color:"–±—ñ–ª–∏–π / –±–µ–∑–±–∞—Ä–≤–Ω–∏–π",hardness:"3",group:"–∫–∞—Ä–±–æ–Ω–∞—Ç–∏"},
  {name:"–§–ª—é–æ—Ä–∏—Ç (–ø–ª–∞–≤–∏–∫–æ–≤–∏–π —à–ø–∞—Ç)",formula:"CaF‚ÇÇ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Fluorite_with_Iron_Pyrite.jpg/440px-Fluorite_with_Iron_Pyrite.jpg",color:"—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π / –∑–µ–ª–µ–Ω–∏–π",hardness:"4",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},
  {name:"–ü—ñ—Ä–∏—Ç (–∑–∞–ª—ñ–∑–Ω–∏–π –∫–æ–ª—á–µ–¥–∞–Ω)",formula:"FeS‚ÇÇ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/Pyrite_from_Huanzala%2C_Peru.jpg/440px-Pyrite_from_Huanzala%2C_Peru.jpg",color:"–∑–æ–ª–æ—Ç–∏—Å—Ç–æ-–∂–æ–≤—Ç–∏–π",hardness:"6-6.5",group:"—Å—É–ª—å—Ñ—ñ–¥–∏"},
  {name:"–ú–∞–≥–Ω–µ—Ç–∏—Ç",formula:"Fe‚ÇÉO‚ÇÑ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/Magnetit_01.jpg/440px-Magnetit_01.jpg",color:"—á–æ—Ä–Ω–∏–π",hardness:"5.5-6.5",group:"–æ–∫—Å–∏–¥–∏"},
  {name:"–ì–µ–º–∞—Ç–∏—Ç (—á–µ—Ä–≤–æ–Ω–∏–π –∑–∞–ª—ñ–∑–Ω—è–∫)",formula:"Fe‚ÇÇO‚ÇÉ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Hematite_Var._Kidney_Ore.jpg/440px-Hematite_Var._Kidney_Ore.jpg",color:"—á–µ—Ä–≤–æ–Ω–æ-–±—É—Ä–∏–π",hardness:"5.5-6.5",group:"–æ–∫—Å–∏–¥–∏"},
  {name:"–ú–∞–ª–∞—Ö—ñ—Ç",formula:"(CuOH)‚ÇÇCO‚ÇÉ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Malachite_%28Kolwezi%2C_Congo%29_2.jpg/440px-Malachite_%28Kolwezi%2C_Congo%29_2.jpg",color:"—è—Å–∫—Ä–∞–≤–æ-–∑–µ–ª–µ–Ω–∏–π",hardness:"3.5-4",group:"–∫–∞—Ä–±–æ–Ω–∞—Ç–∏"},
  {name:"–ö–æ—Ä—É–Ω–¥ (–≥–ª–∏–Ω–æ–∑–µ–º)",formula:"Al‚ÇÇO‚ÇÉ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Corundum-177644.jpg/440px-Corundum-177644.jpg",color:"–±–µ–∑–±–∞—Ä–≤–Ω–∏–π / —Ä—ñ–∑–Ω—ñ",hardness:"9",group:"–æ–∫—Å–∏–¥–∏"},
  {name:"–ì–∞–ª—ñ—Ç (–∫–∞–º'—è–Ω–∞ —Å—ñ–ª—å)",formula:"NaCl",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Halite%28Salt%29USGOV.jpg/440px-Halite%28Salt%29USGOV.jpg",color:"–±–µ–∑–±–∞—Ä–≤–Ω–∏–π / –±—ñ–ª–∏–π",hardness:"2-2.5",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},
  {name:"–ú–∞–≥–Ω–µ–∑–∏—Ç",formula:"MgCO‚ÇÉ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Magnesite_-_Bela_Stena_mine%2C_Brus%2C_Rasina_District%2C_Serbia.jpg/440px-Magnesite_-_Bela_Stena_mine%2C_Brus%2C_Rasina_District%2C_Serbia.jpg",color:"–±—ñ–ª–∏–π / —Å—ñ—Ä–∏–π",hardness:"3.5-4.5",group:"–∫–∞—Ä–±–æ–Ω–∞—Ç–∏"},
  {name:"–î–æ–ª–æ–º—ñ—Ç",formula:"CaMg(CO‚ÇÉ)‚ÇÇ",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Dolomite-Magn%C3%A9site-Fuchsite_-_Cuvier_%28Is%C3%A8re%29.jpg/440px-Dolomite-Magn%C3%A9site-Fuchsite_-_Cuvier_%28Is%C3%A8re%29.jpg",color:"–±—ñ–ª–∏–π / —Å—ñ—Ä—É–≤–∞—Ç–∏–π",hardness:"3.5-4",group:"–∫–∞—Ä–±–æ–Ω–∞—Ç–∏"},
  {name:"–ì—ñ–ø—Å",formula:"CaSO‚ÇÑ¬∑2H‚ÇÇO",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Gypse_Naica.jpg/440px-Gypse_Naica.jpg",color:"–±—ñ–ª–∏–π / –±–µ–∑–±–∞—Ä–≤–Ω–∏–π",hardness:"2",group:"—Å—É–ª—å—Ñ–∞—Ç–∏"},
];

const PHYSICAL_PROPERTIES=[{substance:"–ê–ª–º–∞–∑",property:"–ù–∞–π—Ç–≤–µ—Ä–¥—ñ—à–∞ –ø—Ä–∏—Ä–æ–¥–Ω–∞ —Ä–µ—á–æ–≤–∏–Ω–∞",formula:"C",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ì—Ä–∞—Ñ—ñ—Ç",property:"–ú'—è–∫–∏–π, –∑–∞–ª–∏—à–∞—î —Å—ñ—Ä–∏–π —Å–ª—ñ–¥, –µ–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤—ñ–¥–Ω–∏–π",formula:"C",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ë—ñ–ª–∏–π —Ñ–æ—Å—Ñ–æ—Ä",property:"–°–≤—ñ—Ç–∏—Ç—å—Å—è –≤ —Ç–µ–º—Ä—è–≤—ñ, —Å–∞–º–æ–∑–∞–π–º–∞—î—Ç—å—Å—è",formula:"P‚ÇÑ",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ô–æ–¥",property:"–ó–¥–∞—Ç–Ω–∏–π –¥–æ —Å—É–±–ª—ñ–º–∞—Ü—ñ—ó (—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∞ –ø–∞—Ä–∞)",formula:"I‚ÇÇ",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ë—Ä–æ–º",property:"–Ñ–¥–∏–Ω–∏–π —Ä—ñ–¥–∫–∏–π –Ω–µ–º–µ—Ç–∞–ª –∑–∞ –∑–≤–∏—á–∞–π–Ω–∏—Ö —É–º–æ–≤",formula:"Br‚ÇÇ",group:"—Ä—ñ–¥–∫—ñ"},{substance:"–†—Ç—É—Ç—å",property:"–Ñ–¥–∏–Ω–∏–π —Ä—ñ–¥–∫–∏–π –º–µ—Ç–∞–ª –∑–∞ –∑–≤–∏—á–∞–π–Ω–∏—Ö —É–º–æ–≤",formula:"Hg",group:"—Ä—ñ–¥–∫—ñ"},{substance:"–û–∑–æ–Ω",property:"–ó–∞–ø–∞—Ö —Å–≤—ñ–∂–æ—Å—Ç—ñ –ø—ñ—Å–ª—è –≥—Ä–æ–∑–∏",formula:"O‚ÇÉ",group:"–≥–∞–∑–∏"},{substance:"–°—ñ—Ä–∫–æ–≤–æ–¥–µ–Ω—å",property:"–ó–∞–ø–∞—Ö —Ç—É—Ö–ª–∏—Ö —è—î—Ü—å",formula:"H‚ÇÇS",group:"–≥–∞–∑–∏"},{substance:"–•–ª–æ—Ä",property:"–ñ–æ–≤—Ç–æ-–∑–µ–ª–µ–Ω–∏–π –≥–∞–∑, –∑–∞–¥—É—à–ª–∏–≤–∏–π –∑–∞–ø–∞—Ö",formula:"Cl‚ÇÇ",group:"–≥–∞–∑–∏"},{substance:"–ê–º—ñ–∞–∫",property:"–†—ñ–∑–∫–∏–π –∑–∞–ø–∞—Ö, –ª–µ–≥—à–∏–π –∑–∞ –ø–æ–≤—ñ—Ç—Ä—è",formula:"NH‚ÇÉ",group:"–≥–∞–∑–∏"},{substance:"–°—ñ—Ä—á–∏—Å—Ç–∏–π –≥–∞–∑",property:"–ó–∞–ø–∞—Ö –ø–∞–ª–µ–Ω–æ–≥–æ —Å—ñ—Ä–Ω–∏–∫–∞",formula:"SO‚ÇÇ",group:"–≥–∞–∑–∏"},{substance:"–ß–∞–¥–Ω–∏–π –≥–∞–∑",property:"–ë–µ–∑ –∫–æ–ª—å–æ—Ä—É, –±–µ–∑ –∑–∞–ø–∞—Ö—É, –¥—É–∂–µ –æ—Ç—Ä—É–π–Ω–∏–π",formula:"CO",group:"–≥–∞–∑–∏"},{substance:"–°—É—Ö–∏–π –ª—ñ–¥",property:"–°—É–±–ª—ñ–º—É—î –∑–∞ –∑–≤–∏—á–∞–π–Ω–∏—Ö —É–º–æ–≤ (–Ω–µ –ø–ª–∞–≤–∏—Ç—å—Å—è)",formula:"CO‚ÇÇ (—Ç–≤.)",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–°—ñ—Ä–∫–∞ —Ä–æ–º–±—ñ—á–Ω–∞",property:"–ñ–æ–≤—Ç—ñ –∫—Ä–∏—Å—Ç–∞–ª–∏, –Ω–µ –∑–º–æ—á—É—é—Ç—å—Å—è –≤–æ–¥–æ—é",formula:"S‚Çà",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ú—ñ–¥–Ω–∏–π –∫—É–ø–æ—Ä–æ—Å",property:"–°–∏–Ω—ñ –∫—Ä–∏—Å—Ç–∞–ª–∏, —É –≤–æ–¥—ñ ‚Äî –±–ª–∞–∫–∏—Ç–Ω–∏–π —Ä–æ–∑—á–∏–Ω",formula:"CuSO‚ÇÑ¬∑5H‚ÇÇO",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ó–∞–ª—ñ–∑–Ω–∏–π –∫—É–ø–æ—Ä–æ—Å",property:"–°–≤—ñ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ñ –∫—Ä–∏—Å—Ç–∞–ª–∏",formula:"FeSO‚ÇÑ¬∑7H‚ÇÇO",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ß–µ—Ä–≤–æ–Ω–∏–π —Ñ–æ—Å—Ñ–æ—Ä",property:"–ù–µ–æ—Ç—Ä—É–π–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Å—ñ—Ä–Ω–∏–∫–∞—Ö",formula:"P",group:"—Ç–≤–µ—Ä–¥—ñ"},{substance:"–ü–ª–∞–≤–∏–∫–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",property:"–†—É–π–Ω—É—î —Å–∫–ª–æ",formula:"HF",group:"—Ä—ñ–¥–∫—ñ"}];

const SMELLS=[{substance:"–û–∑–æ–Ω (O‚ÇÉ)",smell:"–°–≤—ñ–∂—ñ—Å—Ç—å –ø—ñ—Å–ª—è –≥—Ä–æ–∑–∏",emoji:"‚õàÔ∏è",color:"#d0e8ed",group:"–Ω–µ–æ—Ä–≥"},{substance:"–°—ñ—Ä–∫–æ–≤–æ–¥–µ–Ω—å (H‚ÇÇS)",smell:"–¢—É—Ö–ª—ñ —è–π—Ü—è",emoji:"ü•ö",color:"#e8ddb0",group:"–Ω–µ–æ—Ä–≥"},{substance:"–ê–º—ñ–∞–∫ (NH‚ÇÉ)",smell:"–†—ñ–∑–∫–∏–π —ó–¥–∫–∏–π (–Ω–∞—à–∞—Ç–∏—Ä)",emoji:"üß™",color:"#c0d8ea",group:"–Ω–µ–æ—Ä–≥"},{substance:"–•–ª–æ—Ä (Cl‚ÇÇ)",smell:"–ó–∞–¥—É—à–ª–∏–≤–∏–π (—Ö–ª–æ—Ä–∫–∞/–±–∞—Å–µ–π–Ω)",emoji:"üèä",color:"#d0e8d0",group:"–Ω–µ–æ—Ä–≥"},{substance:"–°—ñ—Ä—á–∏—Å—Ç–∏–π –≥–∞–∑ (SO‚ÇÇ)",smell:"–ü–∞–ª–µ–Ω–∏–π —Å—ñ—Ä–Ω–∏–∫",emoji:"üî•",color:"#e8d8a0",group:"–Ω–µ–æ—Ä–≥"},{substance:"–û—Ü—Ç–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞ (CH‚ÇÉCOOH)",smell:"–û—Ü–µ—Ç",emoji:"ü´ó",color:"#e0c8c8",group:"–æ—Ä–≥"},{substance:"–ú—É—Ä–∞—à–∏–Ω–∞ –∫–∏—Å–ª–æ—Ç–∞ (HCOOH)",smell:"–†—ñ–∑–∫–∏–π –∫–∏—Å–ª–∏–π",emoji:"üêú",color:"#c0d8d0",group:"–æ—Ä–≥"},{substance:"–§–æ—Ä–º–∞–ª—å–¥–µ–≥—ñ–¥ (HCHO)",smell:"–†—ñ–∑–∫–∏–π –∑–∞–¥—É—à–ª–∏–≤–∏–π (—Ñ–æ—Ä–º–∞–ª—ñ–Ω)",emoji:"üè•",color:"#d8c8e0",group:"–æ—Ä–≥"},{substance:"–ï—Ç–∞–Ω–æ–ª (C‚ÇÇH‚ÇÖOH)",smell:"–•–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∏–π —Å–ø–∏—Ä—Ç–æ–≤–∏–π",emoji:"üç∑",color:"#e0c0c0",group:"–æ—Ä–≥"},{substance:"–ú–µ—Ç–∞–Ω–æ–ª (CH‚ÇÉOH)",smell:"–°—Ö–æ–∂–∏–π –Ω–∞ –µ—Ç–∞–Ω–æ–ª (–û–¢–†–£–ô–ù–ò–ô!)",emoji:"‚ò†Ô∏è",color:"#c8c8c8",group:"–æ—Ä–≥"},{substance:"–ê—Ü–µ—Ç–æ–Ω ((CH‚ÇÉ)‚ÇÇCO)",smell:"–†—ñ–∑–∫–∏–π —Å–æ–ª–æ–¥–∫—É–≤–∞—Ç–∏–π (—Ä—ñ–¥–∏–Ω–∞ –¥–ª—è –∑–Ω—è—Ç—Ç—è –ª–∞–∫—É)",emoji:"üíÖ",color:"#e8c8d0",group:"–æ—Ä–≥"},{substance:"–§–µ–Ω–æ–ª (C‚ÇÜH‚ÇÖOH)",smell:"–•–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∏–π ¬´–∞–ø—Ç–µ—á–Ω–∏–π¬ª (–≥—É–∞—à—å)",emoji:"üé®",color:"#d8d0c0",group:"–æ—Ä–≥"}];

const PRECIPITATE_COLORS=[{formula:"AgCl‚Üì",color:"#f0f0e0",colorName:"–±—ñ–ª–∏–π (—Å–∏—Ä–Ω–∏—Å—Ç–∏–π)",reagents:"Ag‚Å∫ + Cl‚Åª",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},{formula:"AgBr‚Üì",color:"#fffdd0",colorName:"–±–ª—ñ–¥–æ-–∂–æ–≤—Ç–∏–π",reagents:"Ag‚Å∫ + Br‚Åª",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},{formula:"AgI‚Üì",color:"#ffd700",colorName:"–∂–æ–≤—Ç–∏–π",reagents:"Ag‚Å∫ + I‚Åª",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},{formula:"BaSO‚ÇÑ‚Üì",color:"#fafafa",colorName:"–±—ñ–ª–∏–π",reagents:"Ba¬≤‚Å∫ + SO‚ÇÑ¬≤‚Åª",group:"—Å—É–ª—å—Ñ–∞—Ç–∏"},{formula:"CaCO‚ÇÉ‚Üì",color:"#f5f5f0",colorName:"–±—ñ–ª–∏–π",reagents:"Ca¬≤‚Å∫ + CO‚ÇÉ¬≤‚Åª",group:"–∫–∞—Ä–±–æ–Ω–∞—Ç–∏"},{formula:"Fe(OH)‚ÇÇ‚Üì",color:"#c8d8c0",colorName:"–±—ñ–ª–∏–π ‚Üí –∑–µ–ª–µ–Ω—ñ—î",reagents:"Fe¬≤‚Å∫ + 2OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"Fe(OH)‚ÇÉ‚Üì",color:"#8B4513",colorName:"–±—É—Ä–∏–π (—ñ—Ä–∂–∞–≤–∏–π)",reagents:"Fe¬≥‚Å∫ + 3OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"Cu(OH)‚ÇÇ‚Üì",color:"#4169E1",colorName:"–±–ª–∞–∫–∏—Ç–Ω–∏–π",reagents:"Cu¬≤‚Å∫ + 2OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"Zn(OH)‚ÇÇ‚Üì",color:"#f0f0f0",colorName:"–±—ñ–ª–∏–π (–¥—Ä–∞–≥–ª–∏—Å—Ç–∏–π)",reagents:"Zn¬≤‚Å∫ + 2OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"Al(OH)‚ÇÉ‚Üì",color:"#f8f8f8",colorName:"–±—ñ–ª–∏–π (–¥—Ä–∞–≥–ª–∏—Å—Ç–∏–π)",reagents:"Al¬≥‚Å∫ + 3OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"Mg(OH)‚ÇÇ‚Üì",color:"#f5f5f5",colorName:"–±—ñ–ª–∏–π",reagents:"Mg¬≤‚Å∫ + 2OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"},{formula:"PbI‚ÇÇ‚Üì",color:"#FFD700",colorName:"—è—Å–∫—Ä–∞–≤–æ-–∂–æ–≤—Ç–∏–π",reagents:"Pb¬≤‚Å∫ + 2I‚Åª",group:"–≥–∞–ª–æ–≥–µ–Ω—ñ–¥–∏"},{formula:"PbS‚Üì",color:"#1a1a1a",colorName:"—á–æ—Ä–Ω–∏–π",reagents:"Pb¬≤‚Å∫ + S¬≤‚Åª",group:"—Å—É–ª—å—Ñ—ñ–¥–∏"},{formula:"CuS‚Üì",color:"#222",colorName:"—á–æ—Ä–Ω–∏–π",reagents:"Cu¬≤‚Å∫ + S¬≤‚Åª",group:"—Å—É–ª—å—Ñ—ñ–¥–∏"},{formula:"MnO‚ÇÇ‚Üì",color:"#3d2b1f",colorName:"—Ç–µ–º–Ω–æ-–±—É—Ä–∏–π",reagents:"Mn‚Å¥‚Å∫",group:"–æ–∫—Å–∏–¥–∏"},{formula:"Cr(OH)‚ÇÉ‚Üì",color:"#556b2f",colorName:"—Å—ñ—Ä–æ-–∑–µ–ª–µ–Ω–∏–π",reagents:"Cr¬≥‚Å∫ + 3OH‚Åª",group:"–≥—ñ–¥—Ä–æ–∫—Å–∏–¥–∏"}];

const FLAME_COLORS=[{ion:"Na‚Å∫",color:"#FFD700",colorName:"–∂–æ–≤—Ç–∏–π"},{ion:"K‚Å∫",color:"#DA70D6",colorName:"—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π"},{ion:"Li‚Å∫",color:"#DC143C",colorName:"–∫–∞—Ä–º—ñ–Ω–æ–≤–æ-—á–µ—Ä–≤–æ–Ω–∏–π"},{ion:"Ca¬≤‚Å∫",color:"#FF4500",colorName:"—Ü–µ–≥–ª–∏—Å—Ç–æ-—á–µ—Ä–≤–æ–Ω–∏–π"},{ion:"Sr¬≤‚Å∫",color:"#FF0000",colorName:"—á–µ—Ä–≤–æ–Ω–∏–π"},{ion:"Ba¬≤‚Å∫",color:"#7CFC00",colorName:"–∂–æ–≤—Ç–æ-–∑–µ–ª–µ–Ω–∏–π"},{ion:"Cu¬≤‚Å∫",color:"#00CED1",colorName:"–∑–µ–ª–µ–Ω–æ-–±–ª–∞–∫–∏—Ç–Ω–∏–π"}];

const APPLICATIONS=[{substance:"CaO (–Ω–µ–≥–∞—à–µ–Ω–µ –≤–∞–ø–Ω–æ)",apps:["–±—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ","–≤–∞–ø–Ω—É–≤–∞–Ω–Ω—è “ë—Ä—É–Ω—Ç—ñ–≤"],wrong:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ —Å–∫–ª–∞","–≤—ñ–¥–±—ñ–ª—é–≤–∞–Ω–Ω—è —Ç–∫–∞–Ω–∏–Ω","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É"]},{substance:"NaHCO‚ÇÉ (—Ö–∞—Ä—á–æ–≤–∞ —Å–æ–¥–∞)",apps:["–∫—É–ª—ñ–Ω–∞—Ä—ñ—è (—Ä–æ–∑–ø—É—à—É–≤–∞—á)","–º–µ–¥–∏—Ü–∏–Ω–∞ (–ø—Ä–∏ –ø–µ—á—ñ—ó)"],wrong:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –º–∏–ª–∞","–≥–∞–ª—å–≤–∞–Ω—ñ–∑–∞—Ü—ñ—è","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É"]},{substance:"NaOH (–∫–∞—É—Å—Ç–∏—á–Ω–∞ —Å–æ–¥–∞)",apps:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –º–∏–ª–∞","–æ—á–∏—â–µ–Ω–Ω—è —Å—Ç—ñ—á–Ω–∏—Ö –≤–æ–¥"],wrong:["–∫—É–ª—ñ–Ω–∞—Ä—ñ—è","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è"]},{substance:"AgNO‚ÇÉ (–ª—è–ø—ñ—Å)",apps:["–º–µ–¥–∏—Ü–∏–Ω–∞ (–ø—Ä–∏–ø—ñ–∫–∞–Ω–Ω—è)","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è"],wrong:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –º–∏–ª–∞","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É","–±—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ"]},{substance:"KNO‚ÇÉ (–∫–∞–ª—ñ–π–Ω–∞ —Å–µ–ª—ñ—Ç—Ä–∞)",apps:["–¥–æ–±—Ä–∏–≤–æ","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É"],wrong:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –º–∏–ª–∞","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è","–æ—á–∏—â–µ–Ω–Ω—è –≤–æ–¥–∏"]},{substance:"CuSO‚ÇÑ¬∑5H‚ÇÇO (–º—ñ–¥–Ω–∏–π –∫—É–ø–æ—Ä–æ—Å)",apps:["—Ñ—É–Ω–≥—ñ—Ü–∏–¥","–≥–∞–ª—å–≤–∞–Ω—ñ–∑–∞—Ü—ñ—è"],wrong:["—Ä–æ–∑–ø—É—à—É–≤–∞—á —Ç—ñ—Å—Ç–∞","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è"]},{substance:"KClO‚ÇÉ (–±–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤–∞ —Å—ñ–ª—å)",apps:["–ø—ñ—Ä–æ—Ç–µ—Ö–Ω—ñ–∫–∞","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ —Å—ñ—Ä–Ω–∏–∫—ñ–≤"],wrong:["–¥–æ–±—Ä–∏–≤–æ","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è","–æ—á–∏—â–µ–Ω–Ω—è –≤–æ–¥–∏"]},{substance:"Na‚ÇÇSiO‚ÇÉ (—Ä—ñ–¥–∫–µ —Å–∫–ª–æ)",apps:["–≤–æ–≥–Ω–µ—Ç—Ä–∏–≤–∫–µ –ø—Ä–æ—Å–æ—á–µ–Ω–Ω—è","–±—É–¥—ñ–≤–µ–ª—å–Ω–∏–π –∫–ª–µ–π"],wrong:["—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è","—Ñ—É–Ω–≥—ñ—Ü–∏–¥","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É"]},{substance:"NH‚ÇÑNO‚ÇÉ (–∞–º—ñ–∞—á–Ω–∞ —Å–µ–ª—ñ—Ç—Ä–∞)",apps:["–¥–æ–±—Ä–∏–≤–æ","–≤–∏–±—É—Ö–æ–≤—ñ —Ä–µ—á–æ–≤–∏–Ω–∏"],wrong:["–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –º–∏–ª–∞","—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è","—Ñ—É–Ω–≥—ñ—Ü–∏–¥"]},{substance:"Ca(OH)‚ÇÇ (–≥–∞—à–µ–Ω–µ –≤–∞–ø–Ω–æ)",apps:["–ø–æ–±—ñ–ª–∫–∞","–∑–Ω–µ–∑–∞—Ä–∞–∂–µ–Ω–Ω—è –≤–æ–¥–∏"],wrong:["—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—è","–≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ –ø–æ—Ä–æ—Ö—É","–≥–∞–ª—å–≤–∞–Ω—ñ–∑–∞—Ü—ñ—è"]}];

const ORGANIC_NAMES=[{systematic:"–ú–µ—Ç–∞–Ω–∞–ª—å",trivial:"–§–æ—Ä–º–∞–ª—å–¥–µ–≥—ñ–¥",formula:"HCHO",group:"–∞–ª—å–¥–µ–≥—ñ–¥–∏"},{systematic:"–ï—Ç–∞–Ω–∞–ª—å",trivial:"–ê—Ü–µ—Ç–∞–ª—å–¥–µ–≥—ñ–¥",formula:"CH‚ÇÉCHO",group:"–∞–ª—å–¥–µ–≥—ñ–¥–∏"},{systematic:"–ú–µ—Ç–∞–Ω–æ–ª",trivial:"–î–µ—Ä–µ–≤–Ω–∏–π —Å–ø–∏—Ä—Ç",formula:"CH‚ÇÉOH",group:"—Å–ø–∏—Ä—Ç–∏"},{systematic:"–ï—Ç–∞–Ω–æ–ª",trivial:"–í–∏–Ω–Ω–∏–π —Å–ø–∏—Ä—Ç",formula:"C‚ÇÇH‚ÇÖOH",group:"—Å–ø–∏—Ä—Ç–∏"},{systematic:"–ü—Ä–æ–ø–∞–Ω–æ–Ω",trivial:"–ê—Ü–µ—Ç–æ–Ω",formula:"CH‚ÇÉCOCH‚ÇÉ",group:"–∫–µ—Ç–æ–Ω–∏"},{systematic:"–ï—Ç–∞–Ω–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",trivial:"–û—Ü—Ç–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",formula:"CH‚ÇÉCOOH",group:"–∫–∏—Å–ª–æ—Ç–∏"},{systematic:"–ú–µ—Ç–∞–Ω–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",trivial:"–ú—É—Ä–∞—à–∏–Ω–∞ –∫–∏—Å–ª–æ—Ç–∞",formula:"HCOOH",group:"–∫–∏—Å–ª–æ—Ç–∏"},{systematic:"–ï—Ç–µ–Ω",trivial:"–ï—Ç–∏–ª–µ–Ω",formula:"C‚ÇÇH‚ÇÑ",group:"–∞–ª–∫–µ–Ω–∏"},{systematic:"–ï—Ç–∏–Ω",trivial:"–ê—Ü–µ—Ç–∏–ª–µ–Ω",formula:"C‚ÇÇH‚ÇÇ",group:"–∞–ª–∫—ñ–Ω–∏"},{systematic:"–ú–µ—Ç–∏–ª–±–µ–Ω–∑–µ–Ω",trivial:"–¢–æ–ª—É–æ–ª",formula:"C‚ÇÜH‚ÇÖCH‚ÇÉ",group:"–∞—Ä–µ–Ω–∏"},{systematic:"–î–∏–º–µ—Ç–∏–ª–±–µ–Ω–∑–µ–Ω",trivial:"–ö—Å–∏–ª–æ–ª",formula:"C‚ÇÜH‚ÇÑ(CH‚ÇÉ)‚ÇÇ",group:"–∞—Ä–µ–Ω–∏"},{systematic:"–í—ñ–Ω—ñ–ª–±–µ–Ω–∑–µ–Ω",trivial:"–°—Ç–∏—Ä–æ–ª",formula:"C‚ÇÜH‚ÇÖCH=CH‚ÇÇ",group:"–∞—Ä–µ–Ω–∏"},{systematic:"–Ü–∑–æ–ø—Ä–æ–ø—ñ–ª–±–µ–Ω–∑–µ–Ω",trivial:"–ö—É–º–æ–ª",formula:"C‚ÇÜH‚ÇÖCH(CH‚ÇÉ)‚ÇÇ",group:"–∞—Ä–µ–Ω–∏"},{systematic:"–§–µ–Ω—ñ–ª–∞–º—ñ–Ω",trivial:"–ê–Ω—ñ–ª—ñ–Ω",formula:"C‚ÇÜH‚ÇÖNH‚ÇÇ",group:"–∞–º—ñ–Ω–∏"},{systematic:"–ê–º—ñ–Ω–æ–æ—Ü—Ç–æ–≤–∞ –∫–∏—Å–ª–æ—Ç–∞",trivial:"–ì–ª—ñ—Ü–∏–Ω",formula:"NH‚ÇÇCH‚ÇÇCOOH",group:"–∞–º—ñ–Ω–æ–∫–∏—Å–ª–æ—Ç–∏"},{systematic:"–ì–ª—ñ—Ü–µ—Ä–æ–ª",trivial:"–ì–ª—ñ—Ü–µ—Ä–∏–Ω",formula:"C‚ÇÉH‚ÇÖ(OH)‚ÇÉ",group:"—Å–ø–∏—Ä—Ç–∏"}];

const LEVELS=[
  {id:1,title:"–¢—Ä–∏–≤—ñ–∞–ª—å–Ω—ñ –Ω–∞–∑–≤–∏",subtitle:"–ù–∞–∑–≤–∞ ‚Üí –§–æ—Ä–º—É–ª–∞",icon:"üè∑Ô∏è",color:"#0d8a6a",total:12},
  {id:2,title:"–ú—ñ–Ω–µ—Ä–∞–ª–∏",subtitle:"–í–ø—ñ–∑–Ω–∞–π –º—ñ–Ω–µ—Ä–∞–ª",icon:"üíé",color:"#cc4466",total:10},
  {id:3,title:"–ó–∞–ø–∞—Ö–∏ —Ä–µ—á–æ–≤–∏–Ω",subtitle:"–©–æ —Ç–∞–∫ –ø–∞—Ö–Ω–µ?",icon:"üëÉ",color:"#8844cc",total:10},
  {id:4,title:"–ö–æ–ª—å–æ—Ä–∏ –æ—Å–∞–¥—ñ–≤",subtitle:"–•—ñ–º—ñ—è –∫–æ–ª—å–æ—Ä—ñ–≤",icon:"üé®",color:"#cc7722",total:12},
  {id:5,title:"–§—ñ–∑–∏—á–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ",subtitle:"–•—Ç–æ —Ü–µ?",icon:"üî¨",color:"#6644bb",total:10},
  {id:6,title:"–ó–∞–±–∞—Ä–≤–ª–µ–Ω–Ω—è –ø–æ–ª—É–º'—è",subtitle:"–Ü–æ–Ω–∏ –≤ –ø–æ–ª—É–º'—ó",icon:"üî•",color:"#cc6644",total:7},
  {id:7,title:"–ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è",subtitle:"–î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å?",icon:"üè≠",color:"#0d8a6a",total:10},
  {id:8,title:"–û—Ä–≥–∞–Ω—ñ–∫–∞",subtitle:"–°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–∞ ‚Üî —Ç—Ä–∏–≤—ñ–∞–ª—å–Ω–∞",icon:"‚öóÔ∏è",color:"#cc9922",total:12},
  {id:9,title:"–§—ñ–Ω–∞–ª—å–Ω–∏–π —ñ—Å–ø–∏—Ç",subtitle:"–ú—ñ–∫—Å —É—Å—ñ—Ö —Ç–µ–º",icon:"üèÜ",color:"#0077aa",total:15},
];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê UTILS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function shuffle(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]];}return b;}
function pick(a,n){return shuffle(a).slice(0,n);}

/* Smart distractor: pick from same group first, then others */
function smartDistractors(pool, correct, key, groupKey, n){
  const sameGroup=pool.filter(x=>x!==correct&&x[groupKey]===correct[groupKey]);
  const diffGroup=pool.filter(x=>x!==correct&&x[groupKey]!==correct[groupKey]);
  const picked=[];
  const shuf1=shuffle(sameGroup);
  const shuf2=shuffle(diffGroup);
  // prefer ~2 from same group if available
  for(const x of shuf1){if(picked.length>=Math.min(2,n))break;if(!picked.find(p=>p[key]===x[key]))picked.push(x);}
  for(const x of shuf2){if(picked.length>=n)break;if(!picked.find(p=>p[key]===x[key]))picked.push(x);}
  // fill remainder
  for(const x of shuf1){if(picked.length>=n)break;if(!picked.find(p=>p[key]===x[key]))picked.push(x);}
  return picked.slice(0,n).map(x=>x[key]);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SAVE/LOAD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const SAVE_KEY='chem_v3';
function loadP(){try{const d=JSON.parse(localStorage.getItem(SAVE_KEY));if(d&&d.v===3)return d;}catch(e){}return{v:3,unlocked:[1],best:{},tp:0};}
function saveP(p){try{localStorage.setItem(SAVE_KEY,JSON.stringify(p));}catch(e){}}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Q GENERATORS (no repeats) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function genBatch(levelId,total){
  const qs=[];
  switch(levelId){
    case 1:{
      const pool=shuffle(TRIVIAL_NAMES).slice(0,total);
      pool.forEach(it=>{
        const distractors=smartDistractors(TRIVIAL_NAMES,it,'formula','group',3);
        const opts=shuffle([it.formula,...distractors]);
        qs.push({prompt:it.trivial,options:opts,correctIndex:opts.indexOf(it.formula),explanation:`${it.trivial} = ${it.formula}`});
      });
      break;
    }
    case 2:{
      const pool=shuffle(MINERALS).slice(0,total);
      pool.forEach(it=>{
        const distractors=smartDistractors(MINERALS,it,'name','group',3);
        const opts=shuffle([it.name,...distractors]);
        qs.push({prompt:it.formula,image:it.img,extraInfo:`–ö–æ–ª—ñ—Ä: ${it.color} | –¢–≤.: ${it.hardness}`,options:opts,correctIndex:opts.indexOf(it.name),explanation:`${it.name} ‚Äî ${it.formula}`});
      });
      break;
    }
    case 3:{
      const pool=shuffle(SMELLS).slice(0,total);
      pool.forEach(it=>{
        const distractors=smartDistractors(SMELLS,it,'substance','group',3);
        const opts=shuffle([it.substance,...distractors]);
        qs.push({prompt:`–ó–∞–ø–∞—Ö: ¬´${it.smell}¬ª ${it.emoji}`,options:opts,correctIndex:opts.indexOf(it.substance),explanation:`${it.substance} ‚Äî ${it.smell}`,cardColor:it.color});
      });
      break;
    }
    case 4:{
      const pool=shuffle(PRECIPITATE_COLORS).slice(0,total);
      pool.forEach((it,i)=>{
        if(i%2===0){
          const distractors=smartDistractors(PRECIPITATE_COLORS,it,'formula','group',3);
          const opts=shuffle([it.formula,...distractors]);
          qs.push({prompt:"–Ø–∫–∏–π –æ—Å–∞–¥ –º–∞—î —Ü–µ–π –∫–æ–ª—ñ—Ä?",extraInfo:it.colorName,swatch:it.color,options:opts,correctIndex:opts.indexOf(it.formula),explanation:`${it.formula} ‚Äî ${it.colorName}`});
        }else{
          const distractors=smartDistractors(PRECIPITATE_COLORS,it,'colorName','group',3);
          const opts=shuffle([it.colorName,...distractors]);
          qs.push({prompt:`–†–µ–∞–∫—Ü—ñ—è: ${it.reagents}`,extraInfo:`–£—Ç–≤–æ—Ä—é—î—Ç—å—Å—è: ${it.formula}`,swatch:it.color,options:opts,correctIndex:opts.indexOf(it.colorName),explanation:`${it.formula} ‚Äî ${it.colorName}`});
        }
      });
      break;
    }
    case 5:{
      const pool=shuffle(PHYSICAL_PROPERTIES).slice(0,total);
      pool.forEach(it=>{
        const distractors=smartDistractors(PHYSICAL_PROPERTIES,it,'substance','group',3);
        const opts=shuffle([it.substance,...distractors]);
        qs.push({prompt:it.property,extraInfo:`–§–æ—Ä–º—É–ª–∞: ${it.formula}`,options:opts,correctIndex:opts.indexOf(it.substance),explanation:`${it.substance} (${it.formula})`});
      });
      break;
    }
    case 6:{
      const pool=shuffle(FLAME_COLORS).slice(0,total);
      pool.forEach(it=>{
        const others=FLAME_COLORS.filter(f=>f!==it);
        const distractors=shuffle(others).slice(0,3).map(f=>f.ion);
        const opts=shuffle([it.ion,...distractors]);
        qs.push({prompt:`–ü–æ–ª—É–º'—è: ${it.colorName}`,swatch:it.color,isFlame:true,options:opts,correctIndex:opts.indexOf(it.ion),explanation:`${it.ion} ‚Äî ${it.colorName}`});
      });
      break;
    }
    case 7:{
      const pool=shuffle(APPLICATIONS).slice(0,total);
      pool.forEach(it=>{
        const ca=it.apps[Math.floor(Math.random()*it.apps.length)];
        const allWrong=[...it.wrong];
        // add plausible distractors from other substances' correct apps
        APPLICATIONS.filter(a=>a!==it).forEach(a=>a.apps.forEach(ap=>{if(!it.apps.includes(ap))allWrong.push(ap);}));
        const distractors=shuffle([...new Set(allWrong)]).slice(0,3);
        const opts=shuffle([ca,...distractors]);
        qs.push({prompt:it.substance,options:opts,correctIndex:opts.indexOf(ca),explanation:`${it.substance}: ${it.apps.join(", ")}`});
      });
      break;
    }
    case 8:{
      const pool=shuffle(ORGANIC_NAMES).slice(0,total);
      pool.forEach((it,i)=>{
        if(i%2===0){
          const distractors=smartDistractors(ORGANIC_NAMES,it,'trivial','group',3);
          const opts=shuffle([it.trivial,...distractors]);
          qs.push({prompt:`–°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–∞: ${it.systematic}`,extraInfo:it.formula,options:opts,correctIndex:opts.indexOf(it.trivial),explanation:`${it.systematic} = ${it.trivial}`});
        }else{
          const distractors=smartDistractors(ORGANIC_NAMES,it,'systematic','group',3);
          const opts=shuffle([it.systematic,...distractors]);
          qs.push({prompt:`–¢—Ä–∏–≤—ñ–∞–ª—å–Ω–∞: ${it.trivial}`,extraInfo:it.formula,options:opts,correctIndex:opts.indexOf(it.systematic),explanation:`${it.trivial} = ${it.systematic}`});
        }
      });
      break;
    }
    case 9:{
      // Mix from all levels, no repeats
      const lvls=[1,2,3,4,5,6,7,8];
      const perLvl=Math.ceil(total/lvls.length);
      const all=[];
      lvls.forEach(lid=>{
        const batch=genBatch(lid,perLvl);
        batch.forEach(q=>{q.levelTag=LEVELS.find(l=>l.id===lid).title;});
        all.push(...batch);
      });
      return shuffle(all).slice(0,total);
    }
  }
  return qs;
}

const LABELS={1:"–Ø–∫–∞ —Ñ–æ—Ä–º—É–ª–∞?",2:"–Ø–∫–∏–π –º—ñ–Ω–µ—Ä–∞–ª?",3:"–Ø–∫–∞ —Ä–µ—á–æ–≤–∏–Ω–∞?",4:"–û–±–µ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:",5:"–Ø–∫–∞ —Ä–µ—á–æ–≤–∏–Ω–∞?",6:"–Ø–∫–∏–π —ñ–æ–Ω?",7:"–î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å?",8:"–û–±–µ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:",9:"–û–±–µ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:"};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUIZ SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function QuizScreen({levelId,onBack,onFinish}){
  const lv=LEVELS.find(l=>l.id===levelId);
  const[questions,setQuestions]=useState([]);
  const[qIdx,setQIdx]=useState(0);
  const[correct,setCorrect]=useState(0);
  const[answered,setAnswered]=useState(null);
  const[finished,setFinished]=useState(false);
  const[points,setPoints]=useState(0);
  const[streak,setStreak]=useState(0);
  const[lastPts,setLastPts]=useState(null);
  const[mistakes,setMistakes]=useState([]);
  const[showMistakes,setShowMistakes]=useState(false);
  const savedRef=useRef(false);

  const init=useCallback(()=>{
    setQuestions(genBatch(levelId,lv.total));
    setQIdx(0);setCorrect(0);setAnswered(null);setFinished(false);
    setPoints(0);setStreak(0);setLastPts(null);setMistakes([]);
    setShowMistakes(false);savedRef.current=false;
  },[levelId,lv.total]);

  useEffect(()=>{init();},[init]);

  // Save on finish
  useEffect(()=>{
    if(!finished||savedRef.current)return;
    savedRef.current=true;
    const pct=Math.round((correct/lv.total)*100);
    const stars=pct>=90?3:pct>=70?2:pct>=50?1:0;
    const passed=pct>=60;
    const prog=loadP();
    if(!prog.best[levelId]||pct>prog.best[levelId].pct)prog.best[levelId]={pct,stars,pts:points};
    if(passed&&levelId<9&&!prog.unlocked.includes(levelId+1))prog.unlocked.push(levelId+1);
    prog.tp=(prog.tp||0)+points;
    saveP(prog);
    if(onFinish)onFinish();
  },[finished,correct,lv.total,points,levelId,onFinish]);

  const answer=useCallback((idx)=>{
    if(answered!==null||!questions.length)return;
    setAnswered(idx);
    const ok=idx===questions[qIdx].correctIndex;
    let pts;
    if(ok){
      const mult=Math.min(streak+1,3);
      pts=10*mult;
      setCorrect(c=>c+1);setStreak(s=>s+1);setPoints(p=>p+pts);
    }else{
      pts=-3;
      setStreak(0);setPoints(p=>Math.max(0,p-3));
      setMistakes(m=>[...m,{prompt:questions[qIdx].prompt,answer:questions[qIdx].options[questions[qIdx].correctIndex],explanation:questions[qIdx].explanation}]);
    }
    setLastPts(pts);
    setTimeout(()=>setLastPts(null),700);
    setTimeout(()=>{
      if(qIdx+1>=lv.total)setFinished(true);
      else{setQIdx(q=>q+1);setAnswered(null);}
    },1300);
  },[answered,qIdx,questions,lv.total,streak]);

  if(!questions.length)return null;

  if(finished){
    const pct=Math.round((correct/lv.total)*100);
    const stars=pct>=90?3:pct>=70?2:pct>=50?1:0;
    const passed=pct>=60;
    const msg=pct>=90?"–ß—É–¥–æ–≤–æ! –¢–∏ ‚Äî –º–∞–π—Å—Ç–µ—Ä! üèÜ":pct>=70?"–î–æ–±—Ä–µ! –ê–ª–µ —î —â–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ üìö":pct>=50?"–ù–µ–ø–æ–≥–∞–Ω–æ, —â–µ –ø–æ–ø—Ä–∞—Ü—é–π üí™":"–ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª üìñ";

    return h('div',{className:'container'},
      h('div',{className:'finish'},
        h('div',{className:'stars-big'},"‚≠ê".repeat(stars)+"‚òÜ".repeat(3-stars)),
        h('h2',null,pct+"% –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö"),
        h('div',{className:'pts-final'},"+"+points+" –±–∞–ª—ñ–≤"),
        h('p',{className:'count'},correct+" –∑ "+lv.total),
        h('p',{className:'msg'},msg),
        passed&&levelId<9?h('div',{className:'unlock-msg'},"üîì –†—ñ–≤–µ–Ω—å "+(levelId+1)+" —Ä–æ–∑–±–ª–æ–∫–æ–≤–∞–Ω–æ!"):null,
        !passed?h('p',{style:{color:'var(--danger)',fontSize:12,marginBottom:14}},"–ü–æ—Ç—Ä—ñ–±–Ω–æ 60%+ —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–≤–µ–Ω—å"):null,
        mistakes.length>0?h('button',{className:'btn-secondary',style:{marginBottom:14,width:'100%'},onClick:()=>setShowMistakes(!showMistakes)},showMistakes?"–°—Ö–æ–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏ ‚ñ≤":"üìù –†–æ–±–æ—Ç–∞ –Ω–∞–¥ –ø–æ–º–∏–ª–∫–∞–º–∏ ("+mistakes.length+") ‚ñº"):null,
        showMistakes?h('div',{className:'mistakes-list'},mistakes.map((m,i)=>h('div',{key:i,className:'mistake-card'},
          h('p',{className:'q'},"‚ùå "+m.prompt),
          h('p',{className:'a'},"‚úÖ "+m.answer),
          h('p',{style:{color:'var(--text3)',fontSize:11,marginTop:1}},m.explanation),
        ))):null,
        h('div',{className:'finish-btns'},
          h('button',{className:'btn-primary',onClick:init},"–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ üîÑ"),
          h('button',{className:'btn-secondary',onClick:onBack},"–î–æ —Ä—ñ–≤–Ω—ñ–≤ ‚Üê"),
        ),
      )
    );
  }

  const cur=questions[qIdx];
  const pctDone=((qIdx+1)/lv.total)*100;

  return h('div',{className:'container'},
    lastPts!==null?h('div',{className:'pts-popup',key:Date.now(),style:{color:lastPts>0?'var(--success)':'var(--danger)'}},(lastPts>0?"+":"")+lastPts):null,
    h('div',{className:'top-bar'},
      h('button',{className:'back-btn',onClick:onBack},"‚Üê"),
      h('h3',null,lv.icon+" "+lv.title),
      h('div',{className:'score-pill'},points),
    ),
    h('div',{className:'progress'},
      h('div',{className:'progress-meta'},h('span',null,(qIdx+1)+"/"+lv.total),h('span',{style:{color:'var(--success)'}},"‚úì "+correct)),
      h('div',{className:'progress-track'},h('div',{className:'progress-fill',style:{width:pctDone+"%",background:lv.color}})),
    ),
    h('div',{className:'streak-bar'},streak>=2?h('div',{className:'streak-badge'+(streak>=3?' big':''),key:streak},"üî• –°–µ—Ä—ñ—è √ó"+Math.min(streak,3)):null),
    h('div',{className:'q-card',key:qIdx,style:cur.cardColor?{background:`linear-gradient(135deg,${cur.cardColor}30,var(--card))`}:{}},
      h('span',{className:'q-num'},"#"+(qIdx+1)),
      cur.levelTag?h('span',{className:'level-tag'},cur.levelTag):null,
      cur.swatch?h('div',{className:'swatch '+(cur.isFlame?'swatch-flame':'swatch-rect'),style:{
        background:cur.isFlame?`radial-gradient(ellipse at bottom,${cur.swatch},${cur.swatch}88,transparent)`:cur.swatch,
        boxShadow:cur.isFlame?`0 0 25px ${cur.swatch}55`:`0 3px 15px ${cur.swatch}44`,
      }}):null,
      cur.image?h('div',{className:'q-image'},h('img',{src:cur.image,alt:"",loading:"lazy",onError:e=>{e.target.style.display='none';}})):null,
      h('p',{className:'prompt'},cur.prompt),
      cur.extraInfo?h('p',{className:'extra'},cur.extraInfo):null,
    ),
    h('p',{className:'prompt-label'},LABELS[levelId]),
    h('div',{className:'options'},cur.options.map((opt,i)=>{
      let cls='opt';
      if(answered!==null){if(i===cur.correctIndex)cls+=' correct';else if(i===answered)cls+=' wrong';else cls+=' dimmed';}
      return h('button',{key:i,className:cls,disabled:answered!==null,onClick:()=>answer(i)},opt);
    })),
    answered!==null?h('div',{className:'feedback '+(answered===cur.correctIndex?'ok':'err')},
      h('p',{className:'verdict',style:{color:answered===cur.correctIndex?'var(--success)':'var(--danger)'}},answered===cur.correctIndex?"‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!":"‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"),
      h('p',{className:'explanation'},cur.explanation),
    ):null,
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REFERENCE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function Reference({onBack}){
  const[tab,setTab]=useState("trivial");
  const tabs=[{id:"trivial",label:"–ù–∞–∑–≤–∏",icon:"üè∑Ô∏è"},{id:"precipitates",label:"–û—Å–∞–¥–∏",icon:"üß™"},{id:"flames",label:"–ü–æ–ª—É–º'—è",icon:"üî•"},{id:"smells",label:"–ó–∞–ø–∞—Ö–∏",icon:"üëÉ"},{id:"minerals",label:"–ú—ñ–Ω–µ—Ä–∞–ª–∏",icon:"üíé"},{id:"organic",label:"–û—Ä–≥–∞–Ω—ñ–∫–∞",icon:"‚öóÔ∏è"}];
  return h('div',{className:'container'},
    h('div',{className:'top-bar'},h('button',{className:'back-btn',onClick:onBack},"‚Üê"),h('h3',null,"üìñ –î–æ–≤—ñ–¥–Ω–∏–∫")),
    h('div',{className:'ref-tabs'},tabs.map(t=>h('button',{key:t.id,className:'ref-tab'+(tab===t.id?' active':''),onClick:()=>setTab(t.id)},t.icon+" "+t.label))),
    tab==="trivial"&&h('div',{style:{display:'flex',flexDirection:'column',gap:5}},TRIVIAL_NAMES.map((t,i)=>h('div',{key:i,className:'list-row'},h('span',{style:{fontSize:13,fontWeight:700}},t.trivial),h('span',{style:{fontSize:12,color:'var(--accent)',fontFamily:'var(--mono)'}},t.formula)))),
    tab==="precipitates"&&h('div',{className:'ref-grid p'},PRECIPITATE_COLORS.map((p,i)=>h('div',{key:i,className:'ref-card'},h('div',{style:{width:40,height:40,borderRadius:8,background:p.color,border:'2px solid var(--border2)',margin:'0 auto 5px',boxShadow:`0 3px 10px ${p.color}33`}}),h('p',{className:'formula'},p.formula),h('p',{className:'detail'},p.colorName),h('p',{className:'detail'},p.reagents)))),
    tab==="flames"&&h('div',{className:'ref-grid f'},FLAME_COLORS.map((f,i)=>h('div',{key:i,className:'ref-card'},h('div',{style:{width:48,height:60,margin:'0 auto 6px',borderRadius:'50% 50% 50% 50% / 60% 60% 40% 40%',background:`radial-gradient(ellipse at bottom,${f.color},${f.color}88,transparent)`,boxShadow:`0 0 18px ${f.color}44`}}),h('p',{className:'formula',style:{fontSize:16}},f.ion),h('p',{className:'detail'},f.colorName)))),
    tab==="smells"&&h('div',{style:{display:'flex',flexDirection:'column',gap:6}},SMELLS.map((s,i)=>h('div',{key:i,className:'smell-row',style:{background:`linear-gradient(135deg,${s.color}22,var(--card))`}},h('span',{className:'emoji'},s.emoji),h('div',null,h('p',{className:'substance'},s.substance),h('p',{className:'smell'},"–ó–∞–ø–∞—Ö: "+s.smell))))),
    tab==="minerals"&&h('div',{className:'ref-grid m'},MINERALS.map((m,i)=>h('div',{key:i,className:'ref-card mineral-card'},h('div',{className:'img-wrap'},h('img',{src:m.img,alt:m.name,loading:"lazy",onError:e=>{e.target.parentElement.innerHTML='<span style="font-size:32px">üíé</span>';}})),h('div',{className:'info'},h('p',{className:'name'},m.name),h('p',{className:'formula'},m.formula),h('p',{className:'detail'},"–ö–æ–ª—ñ—Ä: "+m.color+" | –¢–≤: "+m.hardness))))),
    tab==="organic"&&h('div',{style:{display:'flex',flexDirection:'column',gap:5}},ORGANIC_NAMES.map((o,i)=>h('div',{key:i,className:'list-row',style:{flexDirection:'column',alignItems:'flex-start',gap:1}},h('div',{style:{display:'flex',justifyContent:'space-between',width:'100%'}},h('span',{style:{fontSize:12,fontWeight:700}},o.systematic),h('span',{style:{fontSize:11,color:'var(--accent)',fontFamily:'var(--mono)'}},o.formula)),h('div',{style:{fontSize:11,color:'var(--text3)'}},"= "+o.trivial)))),
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function App(){
  const[screen,setScreen]=useState('home');
  const[activeLevel,setActiveLevel]=useState(null);
  const[progress,setProgress]=useState(loadP());
  const[showReset,setShowReset]=useState(false);
  const refresh=()=>setProgress(loadP());
  const totalStars=Object.values(progress.best).reduce((s,b)=>s+(b.stars||0),0);

  if(screen==='ref')return h('div',{className:'app'},h(Reference,{onBack:()=>setScreen('home')}));
  if(screen==='quiz')return h('div',{className:'app'},h(QuizScreen,{levelId:activeLevel,onBack:()=>{refresh();setScreen('home');},onFinish:refresh}));

  return h('div',{className:'app'},
    h('div',{className:'container'},
      h('div',{className:'header'},h('div',{className:'header-flask'},"‚öóÔ∏è"),h('h1',null,"–•—ñ–º–¢—Ä–µ–Ω–µ—Ä"),h('p',{className:'sub'},"–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä –∑ —Ö—ñ–º—ñ—ó")),
      h('div',{className:'stats-bar'},
        h('div',{className:'stat-chip'},h('div',{className:'val'},totalStars+"/"+LEVELS.length*3),h('div',{className:'label'},"‚≠ê –∑—ñ—Ä–æ–∫")),
        h('div',{className:'stat-chip'},h('div',{className:'val'},progress.unlocked.length+"/"+LEVELS.length),h('div',{className:'label'},"üîì —Ä—ñ–≤–Ω—ñ–≤")),
        h('div',{className:'stat-chip'},h('div',{className:'val'},progress.tp||0),h('div',{className:'label'},"üíé –±–∞–ª—ñ–≤")),
      ),
      h('button',{className:'ref-btn',onClick:()=>setScreen('ref')},h('span',{className:'icon'},"üìñ"),h('div',null,h('p',{className:'title'},"–î–æ–≤—ñ–¥–Ω–∏–∫"),h('p',{className:'sub'},"–ù–∞–∑–≤–∏, –æ—Å–∞–¥–∏, –ø–æ–ª—É–º'—è, –∑–∞–ø–∞—Ö–∏, –º—ñ–Ω–µ—Ä–∞–ª–∏, –æ—Ä–≥–∞–Ω—ñ–∫–∞"))),
      h('div',{className:'levels'},LEVELS.map((lv,idx)=>{
        const unlocked=progress.unlocked.includes(lv.id);
        const best=progress.best[lv.id];
        const starsStr=best?"‚≠ê".repeat(best.stars)+"‚òÜ".repeat(3-best.stars):"";
        return h('button',{key:lv.id,className:'level-row'+(unlocked?'':' locked'),style:{animationDelay:(idx*.04)+'s'},
          onClick:()=>{if(unlocked){setActiveLevel(lv.id);setScreen('quiz');}},
          onMouseEnter:e=>{if(unlocked)e.currentTarget.style.borderColor=lv.color;},
          onMouseLeave:e=>{e.currentTarget.style.borderColor='';},
        },
          h('div',{className:'icon',style:{background:lv.color+'15'}},lv.icon),
          h('div',{className:'info'},h('p',{className:'name'},lv.id+". "+lv.title),h('p',{className:'sub'},lv.subtitle)),
          best?h('span',{className:'stars-display'},starsStr):null,
          best?h('span',{className:'best-score'},best.pct+"%"):null,
        );
      })),
      h('div',{style:{textAlign:'center',marginTop:20}},h('button',{className:'btn-danger',onClick:()=>setShowReset(true)},"–°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å")),
      h('p',{className:'footer'},"v3.0 ‚Ä¢ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –ó–ù–û/–ù–ú–¢ –∑ —Ö—ñ–º—ñ—ó"),
    ),
    showReset?h('div',{className:'modal-overlay',onClick:()=>setShowReset(false)},h('div',{className:'modal',onClick:e=>e.stopPropagation()},
      h('h3',null,"‚ö†Ô∏è –°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å?"),
      h('p',null,"–£—Å—ñ –∑—ñ—Ä–∫–∏, –±–∞–ª–∏ —Ç–∞ —Ä–æ–∑–±–ª–æ–∫–æ–≤–∞–Ω—ñ —Ä—ñ–≤–Ω—ñ –±—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ."),
      h('div',{className:'btns'},
        h('button',{className:'btn-danger',onClick:()=>{const f={v:3,unlocked:[1],best:{},tp:0};saveP(f);setProgress(f);setShowReset(false);}},"–°–∫–∏–Ω—É—Ç–∏"),
        h('button',{className:'btn-secondary',onClick:()=>setShowReset(false)},"–°–∫–∞—Å—É–≤–∞—Ç–∏"),
      ),
    )):null,
  );
}

ReactDOM.createRoot(document.getElementById('app')).render(h(App));
</script>
</body>
</html>
